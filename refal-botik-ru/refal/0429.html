<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=koi8-r">
<TITLE>refal@botik.ru -- Discussing the Refal programming language, Re</TITLE>
<META NAME="Author" CONTENT="Savtchenko Maxim (savmaxru@gcnet.ru)">
<META NAME="Subject" CONTENT="Re: Conditions in Refal-5.">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Conditions in Refal-5.</H1>
<HR>
<P>
<!-- received="Mon Feb 09 13:42:55 2004" -->
<!-- isoreceived="20040209104255" -->
<!-- sent="Mon, 9 Feb 2004 02:11:24 +0300" -->
<!-- isosent="20040208231124" -->
<!-- name="Savtchenko Maxim" -->
<!-- email="savmaxru@gcnet.ru" -->
<!-- subject="Re: Conditions in Refal-5." -->
<!-- id="003401c3ee98$ebcee3b0$2322140a@home37h2h4mjct" -->
<!-- charset="koi8-r" -->
<!-- inreplyto="000f01c3edb8$ebc334b0$8704000a@Swan" -->
<STRONG>Subject: </STRONG>Re: Conditions in Refal-5.<BR>
<STRONG>From: </STRONG>Savtchenko Maxim (<EM>savmaxru@gcnet.ru</EM>)<BR>
<STRONG>Date: </STRONG>Mon Feb 09 2004 - 02:11:24 MSK
<P>
<UL>
<LI><STRONG>sorted by:</STRONG> 
<A HREF="date.html#429">[ date ]</A>
<A HREF="index.html#429">[ thread ]</A>
<A HREF="subject.html#429">[ subject ]</A>
<A HREF="author.html#429">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0430.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0428.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0428.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0430.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0428.html">Savtchenko Maxim: "Re: Conditions in Refal-5."</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Всем доброго &lt;Время_Суток&gt; :-)
<BR>
<P>Читал АС, много думал. Вокруг этой темы наверняка задолго до меня было сломано
<BR>
немало копий, однако мне захотелось поспорить с некоторыми концепциями. Смотрите
<BR>
далее по тексту.
<BR>
<P>----- Original Message -----
<BR>
From: &quot;Arkady Klimov&quot; &lt;arklimov@keldysh.ru&gt;
<BR>
To: &lt;refal@botik.ru&gt;
<BR>
Sent: Saturday, February 07, 2004 11:28 PM
<BR>
Subject: Re: Conditions in Refal-5.
<BR>
<P><P><EM>&gt; Максим, добрый день,
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Антон уже ответил достаточно полно, я хочу от себя немного добавить.
</EM><BR>
<EM>&gt; Для рефала-6 когда-то (более 10 лет назад) мной было составлено краткое
</EM><BR>
<EM>&gt; формальное описание синтаксиса и семантики(!), в котором проводилась
</EM><BR>
<EM>&gt; идея, что вообще не нужно связывать &quot;образец&quot; и &quot;результат&quot; ни в форме
</EM><BR>
<EM>&gt; [result:pattern], ни в форме [pattern,result], а считать и то и другое
</EM><BR>
частными
<BR>
<EM>&gt; случаями понятия &quot;действие&quot;, &quot;action&quot;, последовательность которых и
</EM><BR>
<EM>&gt; образует &quot;предложение&quot;. (В АС, судя по письму Антона, аналогично).
</EM><BR>
<EM>&gt; При этом за образцом может опять следовать новый образец, так же как за
</EM><BR>
<EM>&gt; результатом - новый результат, например
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; F { s1 e2 : e3 s4 = &lt;Print e2&gt; = &lt;Print e3&gt; };
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; F получает строку и печатает ее без первого, а потом без последнего символа
</EM><BR>
<EM>&gt; Кстати, этот пример использует, что образец как бы &quot;сохраняет аргумент&quot;.
</EM><BR>
<P>Вот здесь мне видится некоторая шероховатость. Вы считаете, что &quot;образец&quot; и
<BR>
&quot;результат&quot; не обязанны чередоваться, и СЛЕДОВАТЕЛЬНО их не нужно связывать. Это
<BR>
утверждение кажется мне не слишком очевидным, ведь возможен и другой подход. Я
<BR>
предлагаю делать так - пару [pattern,result] (или [result:pattern]), как
<BR>
наиболее типичную компоненту предложений выделить как базовое &quot;действие&quot;, а
<BR>
сравнительно редко необходимые одиночные &quot;образцы&quot; и &quot;результаты&quot; рассматривать
<BR>
как частные случаи пар. В этом случае ваш пример становится сокращённой формой
<BR>
записи следующего предложения:
<BR>
<P>F { s1 e2 [, s1 e2] : e3 s4 , &lt;Print e2&gt; [: e_] = &lt;Print e3&gt; };
<BR>
<P>Квадратными скобками выделены дополнения до полной формы записи, &quot;e_&quot; -
<BR>
анонимная e-переменная (кстати, интересно, введены ли в каком-нибудь диалекте
<BR>
Рефала-5 аналоги анонимных переменных Пролога, мечтаю о них всю сознательную
<BR>
жизнь рефальского программиста). Очевидно, что сокращённая запись может быть
<BR>
расширена до полной автоматически, при помощи простого алгоритма: видим два
<BR>
подряд идущих образца - вставляем между ними результат равный первому из них;
<BR>
видим два подряд идущих результата - вставляем между ними образец состоящий из
<BR>
одной анонимной e-переменной. Следует сразу сделать два замечания, одно в
<BR>
пользу такого подхода, другое против. Начну с плохого: глупый компилятор глядя
<BR>
на код &quot;s1 e2, s1 e2&quot; не поймёт, что входное обьектное выражение нужно просто
<BR>
передать дальше неизменным, а будет собирать его из значений переменных при
<BR>
каждом шаге сопоставления. На таком простом примере это не страшно, но если в
<BR>
образце есть открытые переменные, то выходное выражение будет пересобираться при
<BR>
каждом их удлинении. Для решения этой проблемы наверно пришлось бы усложнить
<BR>
приведённый выше алгоритм, чтобы он оставлял транслятору указания рассматривать
<BR>
подобные случаи особым образом. Второе замечание (благоприятное) больше
<BR>
филосовского плана - оно касается случая подряд идущих результатов. В вашем
<BR>
примере не случайно результаты содержат функцию &quot;Print&quot;, у которой есть побочный
<BR>
эффект. Рефал, на мой взгляд, красив именно как функциональный язык, а случай
<BR>
подряд идущих результатов теряет смысл, если у первого из них нет побочного
<BR>
эффекта. Вывод - введение в функциональный язык новой концепции во имя побочных
<BR>
действий мне кажется странным.
<BR>
<P><EM>&gt; В аттаче - файл с текстом этого описания, который входит в состав поставки
</EM><BR>
<EM>&gt; рефала-6. К сожалению, он лежит там в глубоком месте и наверно, редко кто
</EM><BR>
<EM>&gt; на него натыкается.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Семантика там очень формально излагается (да еще на Бог весть каком
</EM><BR>
<EM>&gt; английском) и понять ее наверно может только тот, кто содержательно
</EM><BR>
<EM>&gt; ее уже хорошо знает. Метод описания практически тот же, что использовал
</EM><BR>
<EM>&gt; Романенко в известной книге по Рефалу Плюс, но содержательно семантика
</EM><BR>
<EM>&gt; отличается тем, что у Романенко она давалась для составной конструкции
</EM><BR>
<EM>&gt; вида result:pattern, а у меня этого объединения нет.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Кроме того, обратите внимание что и у Романенко и у меня семантика
</EM><BR>
<EM>&gt; разбивается на систему взаимосвязанных семантик, например, есть семантика
</EM><BR>
<EM>&gt; образца (как операция отождествления с объектным выражением), есть
</EM><BR>
<EM>&gt; семантика блока, есть семантика хвоста или пути.
</EM><BR>
<EM>&gt; У действия есть как бы две семантики: одна определяет результатное выражение,
</EM><BR>
<EM>&gt; передаваемое хвосту, другая - набор присваиваний переменным, точнее,
</EM><BR>
<EM>&gt; расширение исходного набора, тоже передаваемое дальше хвосту.
</EM><BR>
<EM>&gt; Поскольку в рефале нет действий, которые и результат выдают новый и среду
</EM><BR>
<EM>&gt; меняют, то в формализме нет нужды вводить объединенную семантику
</EM><BR>
<EM>&gt; чего-то вроде Вашего БП.
</EM><BR>
<P>Вот тут опять хочется спорить, хотя мои дальнейшие рассуждения очень
<BR>
субъективны. Почему я считаю, что формализм с объединённой семантикой всё-таки
<BR>
необходим, причём именно [pattern,result], а не [result:pattern]? Если взглянуть
<BR>
на макро-объекты Рефала (предложения, блоки, хвосты, и т. д.) как на чёрные
<BR>
ящики (вход - выход, а по середине - ХЗ) то можно заметить что их семантика
<BR>
очень похожа. Они все имеют два входа (поле зрения и множество связанных
<BR>
переменных) и два выхода (аналогично). В общем случае оба выхода существенно
<BR>
зависят от обоих входов, и входы не закорочены на выходы (выходное поле зрения
<BR>
может отличаться от входного, и тоже самое с переменными). У всех них есть
<BR>
ручка, позволяющая получить следующий вариант выхода для того же входа (во
<BR>
всяком случае такую ручку можно безболезненно прикрутить). Теперь, если
<BR>
взглянуть на микро-мир Рефала (&quot;образцы&quot; и &quot;результаты&quot;) с тех же позиций,
<BR>
становится видно, что мельчайшим обьектом, обладающим всеми вышеперечисленными
<BR>
свойствами является пара [pattern,result]. Отдельный &quot;образец&quot; имеет всегда
<BR>
закороченые входное и выходное поля зрения. Отдельный &quot;результат&quot; не зависит от
<BR>
входного поля зрения, имеет всегда закороченые входное и выходное множества
<BR>
связанных переменных и не имеет ручки следующего варианта. Пара [result:pattern]
<BR>
вообще не имеет входных и выходных полей зрения. И только пара [pattern,result]
<BR>
полностью аналогична макро-обьектам. Тут напрашивается аналогия с физикой: у нас
<BR>
есть красивая теория идеального газа. Из чего состоит газ? Можно сказать, что он
<BR>
состоит из ядер и электронов, но всё-же разумнее считать, что он состоит из
<BR>
мельчайших частиц, каждая из которых обладает свойствами всего газа, то есть
<BR>
атомов. А всё что мельче атомов - квантовая физика и вообще не наша область.
<BR>
Такой подход позволяет красиво инкапсулировать уровни мышления, чётко отделить
<BR>
&quot;термодинамику&quot; предложений и блоков от &quot;квантовой механики&quot; сопоставлений и
<BR>
подстановок.
<BR>
<P>В конечном счёте, всё это сплошная метафизика и досужие измышления, так что
<BR>
заранее прошу прощения.
<BR>
<P><EM>&gt; Кроме того, семантика отдельного действия, а у Романенко - &quot;перестройки&quot;,
</EM><BR>
<EM>&gt; дается лишь контексте хвоста (пути). Только для него можно
</EM><BR>
<EM>&gt; сказать, чтО есть его результат.
</EM><BR>
<EM>&gt; Сказать отдельно, чтО есть совокупный результат действия
</EM><BR>
<EM>&gt; образца или перестройки довольно сложно и громоздко: в этот результат,
</EM><BR>
<EM>&gt; помимо значения (объектного выражения), надо еще включать и набор
</EM><BR>
<EM>&gt; связываний для уже определенных переменных, чтобы их использовать
</EM><BR>
<EM>&gt; в дальнейшем вычислении (которых, как и Вас должно быть множество).
</EM><BR>
<EM>&gt; А Вы в своем определении это упустили:
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; &gt;    На выходе 0 - результат подстановки в A переменных связанных во входном
</EM><BR>
поле
<BR>
<EM>&gt; &gt;   зрения, а так же связанных в результате сопоставления P с входным полем
</EM><BR>
<EM>&gt; &gt;    зрения.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; Хотя, у Вас используется понятие &quot;переменных связанных во входном
</EM><BR>
<EM>&gt; поле зрения&quot;, но само оно остается неопределенным.
</EM><BR>
<P>Может я вас не понял, но кажется вы не заметили предложения абзацем выше:
<BR>
&quot;Под полем зрения понимается объектное выражение плюс множество всех связанных
<BR>
переменных с их значениями.&quot;
<BR>
<P><EM>&gt; Короче, сухой остаток в том, что лучше вообще ни в каком порядке
</EM><BR>
<EM>&gt; образец с аргументом не склеивать, а определять каждый отдельно и
</EM><BR>
<EM>&gt; независимо. При этом использовать ли формальный стиль как у нас с
</EM><BR>
<EM>&gt; Романенко, или псевдокод, как у Вас - уже дело вкуса.
</EM><BR>
<EM>&gt; Аркадий.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; ----- Original Message -----
</EM><BR>
<EM>&gt; From: &quot;Anton Orlov&quot; &lt;orlov@mccme.ru&gt;
</EM><BR>
<EM>&gt; To: &lt;refal@botik.ru&gt;
</EM><BR>
<EM>&gt; Sent: Saturday, February 07, 2004 1:50 AM
</EM><BR>
<EM>&gt; Subject: Re: Conditions in Refal-5.
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt;
</EM><BR>
<EM>&gt; |         Добрый вечер!
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | On Fri, Feb 06, 2004 at 12:56:59 +0300, Savtchenko Maxim wrote:
</EM><BR>
<EM>&gt; | &gt; Andrei Klimov &lt;klimov@keldysh.ru&gt; wrote:
</EM><BR>
<EM>&gt; | &gt;
</EM><BR>
<EM>&gt; | &gt; &gt; А по существу (если я правильно понял, что Вы имеете в виду),
</EM><BR>
<EM>&gt; | &gt; &gt; я могу только заметить, что подобная работа по &quot;регуляризации&quot;
</EM><BR>
<EM>&gt; | &gt; &gt; синтаксиса Рефала была проделана на рубеже 80-х и 90-х
</EM><BR>
<EM>&gt; | &gt; &gt; при разработке Рефала Плюс, а затем шлифовалась дальше
</EM><BR>
<EM>&gt; | &gt; &gt; в Рефале-6 (теперь это Refal-J -- Рефал над Явой).
</EM><BR>
<EM>&gt; | &gt;
</EM><BR>
<EM>&gt; | &gt; Андрей, вы наверное обратили основное внимание на фразу:
</EM><BR>
<EM>&gt; | &gt;
</EM><BR>
<EM>&gt; | &gt; &quot;... в нашем случае последнее БП функционально ничем не отличается от
</EM><BR>
<EM>&gt; | &gt; остальных, и поэтому его не стоит выделять синтаксически.&quot;
</EM><BR>
<EM>&gt; | &gt;
</EM><BR>
<EM>&gt; | &gt; Вопрос синтаксиса в моей идее наименее существенен, замеченное вами имело
</EM><BR>
<EM>&gt; | &gt; целью просто чуть-чуть упростить БНФ и никакой смысловой нагрузки не
</EM><BR>
несло.
<BR>
<EM>&gt; | &gt; Мне интересно иное - пробовал ли кто-нибудь взглянуть на СЕМАНТИКУ
</EM><BR>
<EM>&gt; | &gt; предложений немного с другой стороны. Рассмотреть работу предложения не
</EM><BR>
как
<BR>
<EM>&gt; | &gt; &quot;сопоставляем вход с левой частью и заменяем на правую, если выполняются
</EM><BR>
все
<BR>
<EM>&gt; | &gt; условия&quot;, а как на работу соединённых в последовательную цепочку &quot;базовых
</EM><BR>
<EM>&gt; | &gt; предложений&quot;.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Мне кажется, что семантикой рефал-предложения разумно называть
</EM><BR>
<EM>&gt; | функцию из множества рефал-выражений + таблиц означенных
</EM><BR>
<EM>&gt; | переменных в множество рефал-выражений.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Если я правильно понимаю, семантика каждого Вами описанного
</EM><BR>
<EM>&gt; | предложения определяется как семантика рефал5-предложения,
</EM><BR>
<EM>&gt; | которое получается из Вашего заменой каждого базового предложения
</EM><BR>
<EM>&gt; | на [pattern, arg] и формированием последовательности
</EM><BR>
<EM>&gt; | соответствующих условий (перестроек) [arg : pattern].  Это так?
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | То есть Вы, по сути, предлагаете другой вариант не семантики, а
</EM><BR>
<EM>&gt; | синтаксиса предложения, чему и соответствует другая запись в виде
</EM><BR>
<EM>&gt; | БНФ.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Работа по упрощению (регуляризации) синтаксиса Рефала идёт уже
</EM><BR>
<EM>&gt; | давно, про что и написал Андрей Валентинович.  Как результат (или
</EM><BR>
<EM>&gt; | часть) этой работы был создан так называемый Абстрактный
</EM><BR>
<EM>&gt; | Синтаксис (АС), включающий элементы для адекватного отображения
</EM><BR>
<EM>&gt; | программ на всех современных диалектах Рефала.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Некоторую версию АС можно посмотреть по адресу:
</EM><BR>
<EM>&gt; |
</EM><BR>
<A HREF="http://skif.pereslavl.ru/skif/index.cgi?module=chap&action=getpage&data=refal">http://skif.pereslavl.ru/skif/index.cgi?module=chap&action=getpage&data=refal</A>\as
<BR>
-syntax.html
<BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Часть АС, соответствующая рефал5-предложению, выглядит
</EM><BR>
<EM>&gt; | так:
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | e.Sentence ::= /*Empty*/ | t.Action e.Sentence
</EM><BR>
<EM>&gt; | t.Action   ::= t.Pattern | t.Result | t.Block
</EM><BR>
<EM>&gt; | t.Block    ::= (BLOCK e.Branches)
</EM><BR>
<EM>&gt; | e.Branches ::= /*Empty*/ | t.Branch e.Branches
</EM><BR>
<EM>&gt; | t.Branch   ::= (BRANCH e.Sentence)
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | t.Result здесь -- это результатное выражение.  У Вас оно названо
</EM><BR>
<EM>&gt; | expression.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | &gt; Признаюсь в том, что я долго пытался придумать
</EM><BR>
<EM>&gt; | &gt; осмысленный пример предложения, которое в новой семантике проще чем в
</EM><BR>
<EM>&gt; | &gt; традиционной, но увы, видимо я слишком привык думать по старому :-(. Может
</EM><BR>
<EM>&gt; | &gt; вы чем поможете.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Это неудивительно, потому что семантика Ваших предложений слишком
</EM><BR>
<EM>&gt; | просто выражается через семантику обычных рефал5-предложений.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | С другой стороны, приведённая выше часть АС позволяет записывать
</EM><BR>
<EM>&gt; | предложения, которые выразить на Рефале-5 уже не так просто.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Например (в синтаксисе Рефала Плюс):
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | F e1 =
</EM><BR>
<EM>&gt; |     e1 : {
</EM><BR>
<EM>&gt; |         (s2) = s2;
</EM><BR>
<EM>&gt; |         s2 = s2;
</EM><BR>
<EM>&gt; |     } : {
</EM><BR>
<EM>&gt; |         1 = &quot;Refal is cool!&quot;;
</EM><BR>
<EM>&gt; |         2 = &quot;Refal is very cool!&quot;;
</EM><BR>
<EM>&gt; |     };
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; | Чтобы записать это на Рефале-5, придётся использовать либо
</EM><BR>
<EM>&gt; | вспомогательную функцию, либо две копии последнего блока.
</EM><BR>
<EM>&gt; |
</EM><BR>
<EM>&gt; |                                             Антон.
</EM><BR>
<EM>&gt;
</EM><BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0430.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0428.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0428.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0430.html">Arkady Klimov: "Re: Conditions in Refal-5."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0428.html">Savtchenko Maxim: "Re: Conditions in Refal-5."</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.fts.frontec.se/~dast/hypermail/">hypermail 2b25</A> 
: <EM>Mon Oct 25 2004 - 21:24:59 MSD</EM>
</EM>
</SMALL>
</BODY>
</HTML>
