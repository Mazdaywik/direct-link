<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<TITLE>refal@botik.ru -- Discussing the Refal programming language, Re</TITLE>
<META NAME="Author" CONTENT="Andrey Slepuhin (pooh@msu.ru)">
<META NAME="Subject" CONTENT="Re: Refal -&gt; Java?   РефалАС--&gt;АСАИЯ !">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Refal -&gt; Java?   РефалАС--&gt;АСАИЯ !</H1>
<HR>
<P>
<!-- received="Fri Dec 10 15:13:51 1999" -->
<!-- isoreceived="19991210121351" -->
<!-- sent="Fri, 10 Dec 1999 14:56:44 +0300" -->
<!-- isosent="19991210115644" -->
<!-- name="Andrey Slepuhin" -->
<!-- email="pooh@msu.ru" -->
<!-- subject="Re: Refal -&gt; Java?   РефалАС--&gt;АСАИЯ !" -->
<!-- id="3850EA7C.978BE1C2@msu.ru" -->
<!-- inreplyto="006201bf42d8$5f5c0ae0$07aee8c1@rcms.botik.ru" -->
<STRONG>Subject: </STRONG>Re: Refal -> Java?   РефалАС-->АСАИЯ !<BR>
<STRONG>From: </STRONG>Andrey Slepuhin (<EM>pooh@msu.ru</EM>)<BR>
<STRONG>Date: </STRONG>Fri Dec 10 1999 - 14:56:44 MSK
<P>
<UL>
<LI><STRONG>sorted by:</STRONG> 
<A HREF="date.html#61">[ date ]</A>
<A HREF="index.html#61">[ thread ]</A>
<A HREF="subject.html#61">[ subject ]</A>
<A HREF="author.html#61">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0062.html">Sergei M. Abramov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0060.html">Nikolai Kondratiev: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0059.html">Sergei M. Abramov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0064.html">Arkady Klimov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0059.html">Andrey Slepuhin: "Re: Refal -&gt; Java?   РефалАС--&gt;АСАИЯ !"</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
<EM>&gt; &quot;Sergei M. Abramov&quot; wrote:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; День добрый, всем!
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Позвольте краткую реплику, по поводу:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Date: 7 декабря 1999 г. 22:45
</EM><BR>
<EM>&gt; Subject: Refal -&gt; Java
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; ================
</EM><BR>
<EM>&gt; (0) Блестящая идея!
</EM><BR>
<EM>&gt; ================
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Идея компилировать Рефал(ы) в императивный язык (функция--&gt;в функцию,
</EM><BR>
<EM>&gt; развилки--&gt;в &quot;IF&quot;, вызовы--&gt;в CALL, циклы--в циклы) как убедительно
</EM><BR>
<EM>&gt; показал Алик, достояна самого пристального внимания...
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Я давно (с лета!) не испытывал такого Рефал-удовлетворения и
</EM><BR>
<EM>&gt; Рефал-подъема!
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; ===================
</EM><BR>
<EM>&gt; (1) Давно забытое старое
</EM><BR>
<EM>&gt; ===================
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Конечно, идея старая.  И даже был ведь компилятор Рефала Плюс в Си.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Правда, идея Алика--намного глубше ТОГО компилятора--там был все-таки
</EM><BR>
<EM>&gt; виртуальный код.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Основная мысль у Алика (и именно ее надо не потерять), в том, что:
</EM><BR>
<EM>&gt; виртуальный код НЕ НУЖЕН, ОН ТОЛЬКО МЕШАЕТ (!!!).
</EM><BR>
<P>Ну вот...
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; Нужна прямая синтаксическая компиляция из АС в императивный язык (и
</EM><BR>
<EM>&gt; Ява тут не причем):
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; 1    функция--&gt;в функцию;
</EM><BR>
<EM>&gt;       арность--&gt;в арность;
</EM><BR>
<EM>&gt;       коарность--&gt;хотелось бы в коарность, (но можно выкрутиться и
</EM><BR>
<EM>&gt; массивом, хотя надо честно себе сказать--это именно &quot;выкрутиться&quot;,
</EM><BR>
<EM>&gt; кривое решение,  по хорошему надо возвращать раздельно).
</EM><BR>
<P>Если хочется сделать коарность, то зачем изобретать велосипед -
<BR>
функция (a, b) &lt;- f (x, y, z) представляется как:
<BR>
<P>C:
<BR>
&nbsp;&nbsp;объявление:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;res_t f (const obj_t, const obj_t, const obj_t, obj_t*, obj_t*) ;
<BR>
&nbsp;&nbsp;вызов:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;res = f(x,y,z,&amp;a,&amp;b);
<BR>
C++:
<BR>
&nbsp;&nbsp;объявление:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;res_t f (const obj_t, const obj_t, const obj_t, obj_t&amp;, obj_t&amp;);
<BR>
&nbsp;&nbsp;вызов:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;res = f(x,y,z,a,b);
<BR>
Java:
<BR>
&nbsp;&nbsp;объявление:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;Res f (Obj, Obj, Obj, ObjHolder, ObjHolder);
<BR>
&nbsp;&nbsp;вызов:
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ObjHolder _a=new ObjHolder();
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;ObjHolder _b=new ObjHolder();
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;res = f(x,y,z,_a,_b);
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;a=_a.value; b=_b.value;
<BR>
<P>В результат при этом помещается fail и может быть еще какакя-нибудь
<BR>
необходимая информация.
<BR>
Это вполне стандартное представление коарности (см. передачу out и inout
<BR>
параметров в IDL-mapping'е для соответствующих языков - чай не дураки
<BR>
все-таки делали);
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; 2    переменные--&gt;в переменные;
</EM><BR>
<P>На самом деле, с точки зрения эффективности - не факт, что такая
<BR>
реализация будет работать быстрее, чем стековая - это можно будет
<BR>
проверить только на практике. Да и в других отношениях стековая
<BR>
реализация может оказаться удобнее - впрочем, это не утверждение,
<BR>
а скорей раздумья на тему... :-)
<BR>
<P><EM>&gt; 3    развилки--&gt;в &quot;IF&quot;;
</EM><BR>
<P>Вот в этом я совсем не уверен. С точки зрения компиляции в Java
<BR>
развилки в общем случае будут выглядеть примерно так:
<BR>
<P>alt_label: {  // начало развилки
<BR>
&nbsp;&nbsp;alt1: { // первая альтернатива
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if ([FAIL]) break;
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;[ хвост после = ]
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;if ([FAIL]) break alt_label; // а если блок непрозрачный, то можно и
<BR>
глобально
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// пофэйлиться
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;break alt_label;
<BR>
&nbsp;&nbsp;}
<BR>
&nbsp;&nbsp;alt2: { // вторая альтернатива
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;break alt_label;
<BR>
&nbsp;&nbsp;}
<BR>
&nbsp;&nbsp;...
<BR>
&nbsp;&nbsp;[FAIL]
<BR>
}
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; 4    вызовы--&gt;в CALL;
</EM><BR>
<P>Только вот, боюсь, в Java будут проблемы с хвостовой рекурсией.
<BR>
Я пока не вижу, как с ней бороться. Как это делать в C/C++ я
<BR>
могу представить (правда, для стековой реализации, когда все функции
<BR>
имеют
<BR>
один прототип).
<BR>
<P><EM>&gt; 5    циклы--в циклы (хочу в императивном языке иметь метки и GOTO
</EM><BR>
<EM>&gt; внутри тела функции!  Не знаю, в Яве-то они есть?);
</EM><BR>
<P>goto в Java нету, но без них можно обойтись.
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; 6    &quot;::&quot; в присваивания;
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; 7    &quot;:&quot; в цепочку конструкций, с широкой эксплуатацией преимуществ
</EM><BR>
<EM>&gt; массивного представления списков:
</EM><BR>
<EM>&gt;         (а) прямое обращение к термам по индексу;
</EM><BR>
<EM>&gt;         (б) проверка длинны массива, прежде чегм ковыраться в термах.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Ради исторической справедливости скажу, что даже в такой формулировке
</EM><BR>
<EM>&gt; (1--7) идея у нас была уже давно.  А именно,
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     *    я четко помню, что Рутик и СеРгей обсуждали такую компиляция
</EM><BR>
<EM>&gt; (по крайней мере, раздел &quot;2. переменные--&gt;в переменные;&quot; мне помнится
</EM><BR>
<EM>&gt; четко);
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     *    и в своих играх в НИЦЭВТе (Рефал--&gt;ПЛ/1-МДА) я выписывал (но
</EM><BR>
<EM>&gt; не реализовал!) использование &quot;7.б Проверка длинны массива, прежде
</EM><BR>
<EM>&gt; чегм ковыраться в термах&quot;;
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     *    а в понедельник идя из МГУ в метро (за день !!!, когда я от
</EM><BR>
<EM>&gt; Алика узнал о его письме!) с Андреем Слепухиным мы именно такую
</EM><BR>
<EM>&gt; реализацию обсуждали ;-)
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Сказанное выше не умалаяет исторического значения сделанного Аликом
</EM><BR>
<EM>&gt; шага--надо было не просто обсуждать, надо было вспомнить это самое
</EM><BR>
<EM>&gt; &quot;давно забытое старое&quot; и не побояться ярко показать, что оно красиво и
</EM><BR>
<EM>&gt; НАСТОЛЬКО эффективно (надо было попрограммировать и замерить
</EM><BR>
<EM>&gt; эффективность!)
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; СПАСИБО!
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; =============================
</EM><BR>
<EM>&gt; (2) Надо делать быстро и качественно
</EM><BR>
<EM>&gt; =============================
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Это общий мотив всех откликов на Аликино письмо.  И я присоединяююсь к
</EM><BR>
<EM>&gt; этому.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Ну так и давайте от общих слов попробуем перейти к конкретному
</EM><BR>
<EM>&gt; обсуждению (прежде чем перейти к делу ;-).  Тем более (по результатом
</EM><BR>
<EM>&gt; восторженной реакции и после локального обсуждения со Светланой
</EM><BR>
<EM>&gt; Пономаревой) кажется могут быть волонтиры, которые возможно до 15
</EM><BR>
<EM>&gt; января будут иметь &quot;дырку&quot; для написания такого компилятора.
</EM><BR>
<EM>&gt; Сложного-то в нем ничего ведь нету!
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Так что значит &quot;делать быстро и качественно&quot; (чтобы по возможности
</EM><BR>
<EM>&gt; потом не переделывать)?  Мне кажется, это осначает:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     *    Компилировать надо из АС
</EM><BR>
<P>Для этого надо AS довести до стабильного состояния. С моей точки зрения
<BR>
-
<BR>
это не больше пары часов совместного обсуждения при очной встрече
<BR>
всех заинтересованных лиц. При обсуждении по почте может и неделя уйти.
<BR>
<P><EM>&gt;     *    А при чем тут Ява? Компилировать надо в АСАИЯ (в Абстрактный
</EM><BR>
<EM>&gt; Синтаксис Абстрактного Императивного Языка)
</EM><BR>
<P>Только вот боюсь, такой синтаксис будет зафиксировать сложнее, чем
<BR>
рефальский.
<BR>
<P><EM>&gt; =======================
</EM><BR>
<EM>&gt; (3) Компилировать надо из АС
</EM><BR>
<EM>&gt; =======================
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Думаю, с этим тезисом все согласятся.
</EM><BR>
<P>Я не согласен :-)). Это что же, я зря выдачу VC делал? :-[
<BR>
И никто меня не остановил...
<BR>
<P><EM>&gt; Тем самым, после выступления Алика можно сделать два адмнистративных
</EM><BR>
<EM>&gt; заявления:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     -а- работа в направлении &quot;уметь выдавать виртуальный код из
</EM><BR>
<EM>&gt; РефалПлюс компилятора&quot;--имеет низкий приоритет, так как для
</EM><BR>
<EM>&gt; промышленной реализации Аликовой идеи:
</EM><BR>
<EM>&gt;         &gt;...виртуальный код НЕ НУЖЕН, ОН ТОЛЬКО МЕШАЕТ (!!!)
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     -б- работа в направлении &quot;уметь выдавать АС из РефалПлюс
</EM><BR>
<EM>&gt; компилятора&quot;--имеет ВЫСОКИЙ приоритет.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; ========================
</EM><BR>
<EM>&gt; (4) А при чем тут Ява?
</EM><BR>
<EM>&gt; Компилировать надо в АСАИЯ
</EM><BR>
<EM>&gt; ========================
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Объяснюсь.  Ставя задачу именно так &quot;компилировать надо в АСАИЯ&quot;  мы
</EM><BR>
<EM>&gt; легко получаем:
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     -1- не только компилятор Рефал в Яву (я согласен, он весьма
</EM><BR>
<EM>&gt; интересен!) но и компиляторы Рефал-&gt;Си/Си++, и Рефал-&gt;Т-язык (пардон
</EM><BR>
<EM>&gt; за шкурный интерес ;-);
</EM><BR>
<P>Я боюсь, что C, C++ и Java - слишком разные (!) языки, и чтобы хорошо
<BR>
компилировать в них Рефал, возможно придется применять различные
<BR>
механизмы.
<BR>
<P><EM>&gt;     -2- возможность привлечь к разработке волонтеров, которые не знают
</EM><BR>
<EM>&gt; (не хотят спешно изучать) Яву (например: Абрамов, Пономарева);
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt;     -3- да и вообще, это выделение разумной независимой фазы ;-)
</EM><BR>
<P>Так то оно так... Если она сможет выделиться... ;-)
<BR>
<P><EM>&gt; 
</EM><BR>
<EM>&gt; Ну а фаза &quot;АСАИЯ --&gt;Ява&quot; будет задачей на полчаса, для знатоков Явы...
</EM><BR>
<EM>&gt; Впрочем как и фазы &quot;АСАИЯ --&gt;Си&quot;, &quot;АСАИЯ --&gt;Си++&quot;, &quot;АСАИЯ --&gt;Т-язык&quot;.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Вот и все, что я хотел бы сказать по Аликовму письму.
</EM><BR>
<EM>&gt; 
</EM><BR>
<EM>&gt; Самый важный лично для меня тезис:
</EM><BR>
<EM>&gt; ========================
</EM><BR>
<EM>&gt; Андрей Слепухин!  Срочно
</EM><BR>
<EM>&gt; захотелось иметь отдельную
</EM><BR>
<EM>&gt; фазу:  Рефал Плюс--&gt;АС
</EM><BR>
<EM>&gt; ========================
</EM><BR>
<P>Ну если вопрос так стоит... :-))) Как только AS зафиксируем - сразу
<BR>
займусь,
<BR>
благо что лексер уже есть (причем на Рефале).
<BR>
<P>Всего доброго,
<BR>
Андрей
<BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0062.html">Sergei M. Abramov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0060.html">Nikolai Kondratiev: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0059.html">Sergei M. Abramov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ !"</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0064.html">Arkady Klimov: "Re: Refal -&gt; Java?  РефалАС--&gt;АСАИЯ"</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0059.html">Andrey Slepuhin: "Re: Refal -&gt; Java?   РефалАС--&gt;АСАИЯ !"</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.fts.frontec.se/~dast/hypermail/">hypermail 2b25</A> 
: <EM>Mon Oct 25 2004 - 21:24:58 MSD</EM>
</EM>
</SMALL>
</BODY>
</HTML>
