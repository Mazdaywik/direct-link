<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=koi8-r">
<TITLE>refal@botik.ru -- Discussing the Refal programming language, Re</TITLE>
<META NAME="Author" CONTENT="Arkady Klimov (klark@bagirra.net)">
<META NAME="Subject" CONTENT="Re: Evolution of programming languages Was: Об отсечениях внутри блока.">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<H1 ALIGN=CENTER>Re: Evolution of programming languages Was: Об отсечениях внутри блока.</H1>
<HR>
<P>
<!-- received="Thu Nov 30 16:21:01 2000" -->
<!-- isoreceived="20001130132101" -->
<!-- sent="Thu, 30 Nov 2000 15:52:48 +0300" -->
<!-- isosent="20001130125248" -->
<!-- name="Arkady Klimov" -->
<!-- email="klark@bagirra.net" -->
<!-- subject="Re: Evolution of programming languages Was: Об отсечениях внутри блока." -->
<!-- id="008601c05acc$7aa81d40$929943c2@swan" -->
<!-- charset="koi8-r" -->
<!-- inreplyto="03f501c058c8$c57497f0$2b00a8c0@scp1" -->
<STRONG>Subject: </STRONG>Re: Evolution of programming languages Was: Об отсечениях внутри блока.<BR>
<STRONG>From: </STRONG>Arkady Klimov (<EM>klark@bagirra.net</EM>)<BR>
<STRONG>Date: </STRONG>Thu Nov 30 2000 - 15:52:48 MSK
<P>
<UL>
<LI><STRONG>sorted by:</STRONG> 
<A HREF="date.html#144">[ date ]</A>
<A HREF="index.html#144">[ thread ]</A>
<A HREF="subject.html#144">[ subject ]</A>
<A HREF="author.html#144">[ author ]</A>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0145.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0143.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0143.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0145.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0143.html">Arkady Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<!-- reply="end" -->
</UL>
<HR>
<!-- body="start" -->
<P>
Привет всем.
<BR>
<P>Возможно, я в своем письме &quot;погорячился&quot; с сомнениями в ценности откатов,
<BR>
на самом деле они (сомнения) касались ТОЛЬКО особенных средств
<BR>
УПРАВЛЕНИЯ откатами (отсечений и заборов), сами же откаты
<BR>
(откатные функции, прозрачные блоки) я, напротив, очень ценю.
<BR>
<P>В связи с этим хочу высказаться по поводу дизайна откатности в Рефале-Плюс и Рефале-6.
<BR>
Пожалуй, тут самая большая разница между ними.
<BR>
Основные понятия, связанные с откатностью - это понятие откатной/безоткатной функции, прозрачного/непрозрачного блоков, и семантика
<BR>
знака равенства. (К отсечениям и заборам
<BR>
вернемся позже). По этим понятием сравнение выглядит так:
<BR>
<P>&nbsp;В Р+ - по умолчанию функции безоткатные, по специальному указанию - откатные,
<BR>
аналогично блоки: по умолчанию непрозрачные, по специальному указанию - прозрачные.
<BR>
В Р6 - все функции откатные (потенциально), все блоки прозрачные.
<BR>
Согласно моим представлениям, автор Р+ отказался от решения считать функции и
<BR>
обычные блоки {...} прозрачными по умолчанию только из соображений
<BR>
преемственности с Рефалом-5, где все блоки непрозрачные,
<BR>
при этом как бы &quot;наступая на горло&quot; своим представлениям
<BR>
о логичности дизайна (возможно я чересчур категоричен).
<BR>
Но, к сожалению, жизнь показала, что эта &quot;совместимость&quot;
<BR>
так и осталась невостребованной: если по-мелкому, то
<BR>
общее подмножество, можно сказать, есть и при альтернативном решении
<BR>
(если говорить о программах, которые не завершаются аварийно),
<BR>
а если по-крупному, так все равно приходится строить конверторы.
<BR>
И, опять же к сожалению (но это моя субъективная эмоция),
<BR>
Рефалу Плюс теперь приходится и дальше оставаться
<BR>
в рамках этого же дизайна, уже для совместимости с самим собой.
<BR>
В этом смысле Рефал-6 имеет альтернативный дизайн,
<BR>
который внутренне я считаю более логичным и потому не видел
<BR>
целесообразности отказываться от него в движении к Рефалу Плюс.
<BR>
<P>Теперь о равенстве. Нагрузка на этот знак тоже разная, причем и тут и там его семантика
<BR>
является обобщением его семантики в Рефале-5, но разными обобщениями. Напомню:
<BR>
В Р+ равенство означает откат на уровень функции (с точки зрения заборов и отсечений оно
<BR>
равносильно запятой, перед которой стоит достаточное количество отсечений).
<BR>
В Р6 равенство означает абсолютную преграду для откатов, в силу чего в случае неуспеха
<BR>
справа от него просто происходит авария (unexpected Fail или &quot;отождествление невозможно&quot;,
<BR>
в нынешнем рефале-6 аварии не перехватываются, в Рефале Плюс есть перехваты аварий).
<BR>
В связи с этим уместно заметить, что если рассмотреть Базисный подмножества
<BR>
Рефала-5 и Рефала-6, то семантики будут совпадать полностью даже с точки зрения аварий,
<BR>
несмотря на откатность функций рефала-6: этот откат всегда будет пойман равенством
<BR>
перед правой частью, породившей этот вызов. Даже локализация аварии будет такой же,
<BR>
благодаря тому, что после равенства все вызовы метятся компилятором как безоткатные.
<BR>
<P>Теперь вернемся к вопросу о блоках: в рефале-6 все блоки прозрачные. А как сделать блок
<BR>
непрозрачным? Очень просто - поставить перед ним равенство вместо запятой. Это если
<BR>
он был результатным, то есть каждая его ветвь начинается с результатного выражения.
<BR>
А если он был образцовым, то можно поставить равенство чуть раньше, а если это
<BR>
неадекватно (например из источника тоже могут быть откаты), то можно,
<BR>
используя новую е-переменную ez, заменить :{ на :ez = ez:{. (Есть еще возможность просто
<BR>
заменить одиночное двоеточие на двойное). Также можно обойтись и с
<BR>
телом функции, начав его с ez = ez: . И получается, что практическая надобность
<BR>
в безоткатности как специальном средстве языка отпадает.
<BR>
Таким образом, иная семантика равенства в рефале-6 и отсутствие явного указания
<BR>
о безоткатности - очень связанные аспекты. Аналогично с функциями: можно сказать,
<BR>
что откатность функции в Рефале+ управляется декларацией функции, в рефале-6 -
<BR>
вызовом (точнее, контекстом вызова).
<BR>
<P>А насчет той роли, которую равенство играет в Рефале Плюс - так она и там выразима через
<BR>
отсечения, как уже было замечено. При переводе в рефал-6 именно так и нужно будет его выражать.
<BR>
<P>Теперь перейдем к отсечениям и заборам. В целом это решено примерно одинаково,
<BR>
различия есть в обозначениях и в том, что было замечено в предыдущих письмах:
<BR>
в Р+ из блока в роли источника не может выйти усиленный отсечением неуспех, в Р6 может.
<BR>
Конечно, было бы интересно проанализировать и понять, с чем это связано. Возможная
<BR>
гипотеза - блок в роли источника Р+ трактует как результат раскрытия вызова функции.
<BR>
<P>Вообще, думаю, прав Андрей К, что нужно &quot;поверить алгеброй гармонию&quot;:
<BR>
испытать колесики дизайна на оселке метавычислений. Раскрытие вызова - это
<BR>
как раз элемент метавычислений. С этой точки зрения, например, семантика равенства
<BR>
в рефале Плюс может оказаться не вполне адекватной, если, конечно,
<BR>
его не заменить на точное число отсечений еще при вводе.
<BR>
<P>Осмелюсь высказать такую гипотезу, которая видимо, верна как для Р+ так и для Р6:
<BR>
если заборы и отсечения &quot;правильно сбалансированы (неформально: для каждого
<BR>
отсечения соответствующий забор поставлен явно), то (при условии замены = на
<BR>
отсечения в Р+) можно будет выполнять раскрытие вызовов (на верхнем уровне
<BR>
выражения) в блоки, просто вставляя тело функции (сохряняя откатность как
<BR>
прозрачность блока в Р+) через двоеточие после аргумента.
<BR>
Обратную свертку блока в фукцию можно делать только с блоками-источниками Рефала Плюс,
<BR>
а с завершающими блоками, и с любыми блоками Рефала-6 этого, вообще говоря, делать нельзя
<BR>
(из-за возможных избыточных отсечений внутри блока).
<BR>
<P>Теперь было бы интересно узнать, как обстоят дела с отсечениями в АС и его реализации?
<BR>
Нет ли там ограничения, исходящего от рефала Плюс: что нет переходов по отсечениям изнутри
<BR>
блока в роли источника. Надеюсь, что нет, иначе о перспективе переводе с Рефала-6
<BR>
в АС можно будет забыть.
<BR>
<P>Аркадий
<BR>
<P>----- Original Message -----
<BR>
From: Andrei Klimov &lt;Andrei.Klimov@supercompilers.com&gt;
<BR>
To: &lt;refal@botik.ru&gt;
<BR>
Cc: Fedor Romanenko &lt;fedor@blues.ru&gt;
<BR>
Sent: Tuesday, November 28, 2000 2:20 AM
<BR>
Subject: Re: Evolution of programming languages (Was: Об отсечениях внутри блока.)
<BR>
<P><P>| Сергей, добрый день!
<BR>
|
<BR>
| &gt; Добрый день!
<BR>
| &gt;
<BR>
| &gt; &gt; AнК:
<BR>
| &gt; &gt; Также соглашусь с ним в вопросе, что SML более богатый язык,
<BR>
| &gt; &gt; чем Рефал Плюс (по числу понятий, считаемых штуками или
<BR>
| &gt; &gt; попугаями -- кто как хочет;-) -- именно поэтому я сейчас
<BR>
| &gt; &gt; делаю большой проект на SML-е, а не на Рефале.
<BR>
| &gt; &gt; ...
<BR>
| &gt; &gt; Однако, &quot;богатство&quot; языка надо считать, конечно, не &quot;попугаями&quot;,
<BR>
| &gt; &gt; а сопоставляя языковые механизмы и понятия с *целями языка*.
<BR>
| &gt;
<BR>
| &gt; СР:
<BR>
| &gt; Понятное дело... Но ведь я и не сказал, что SML - &quot;хороший&quot; язык, потому что
<BR>
| &gt; в нем много всего! Наоборот, я похвалил его как раз за то, чего в нем нет. И
<BR>
| &gt; рассуждал с точки зрения пользователя определенного типа: а именно, такого,
<BR>
| &gt; который хочет строить свой мир из конструктора (поскольку мне самому это
<BR>
| &gt; нравится). Но ведь такой способ работы устраивает не всех!
<BR>
| &gt;
<BR>
| &gt; Сергей
<BR>
|
<BR>
| АнК:
<BR>
| Согласен, &quot;конструктность&quot; -- очень хорошая цель для языка!
<BR>
| (В скобках заметим: *одна из* целей).
<BR>
|
<BR>
| С этой точки зрения введение откатов и откатных функций
<BR>
| в Рефал повышает его &quot;конструктность&quot;.
<BR>
|
<BR>
| (Хочу подчеркнуть, что я сейчас говорю только о сравнении
<BR>
| разных версий Рефала между собой, а не о Рефалах и SML-ях.
<BR>
| Последние слишком различаются по устройству и удовлетворяют
<BR>
| слишком разным целям.)
<BR>
|
<BR>
| Однако, откатность -- это лишь одно из колесиков Рефала Плюс.
<BR>
| Если откатность не нравится, надо ставить вопрос всерьез и по крупному:
<BR>
|
<BR>
|     Достичь *тех же целей* без откатности!
<BR>
|
<BR>
| Если кто-то сможет это сделать, это будет прекрасным
<BR>
| продолжением эволюции Рефала во &quot;второй стадии&quot;.
<BR>
|
<BR>
| Но сначала надо сформулировать хотя бы часть целей.
<BR>
| Это нетрудно, поскольку Сергей Романенко сделал это сам
<BR>
| 10-15 лет тому назад (см. его препринт &quot;Рефал-4...&quot;):
<BR>
|
<BR>
|     Сделать выразимым на самом языке те преобразования
<BR>
|     (разные оптимизации, прогонку и т.п.),
<BR>
|     которые до этого формулировались на других языках:
<BR>
|     &quot;языке сборки&quot;, Рефал-графах и т.д.
<BR>
|
<BR>
| И надо заметить, что эта &quot;сумасбродная&quot; цель была достигнута
<BR>
| в Рефале Плюс без разрушения многих других свойств Рефала!
<BR>
| &quot;Язык сборки&quot; и Рефал-графы тоже удовлетворяют этой цели,
<BR>
| но это (мягко говоря) уж очень другие языки.
<BR>
|
<BR>
| А для чего это нужно? -- Назову 2 &quot;мелочи&quot; и одну &quot;крупную цель&quot;.
<BR>
|
<BR>
| &quot;Мелочи&quot;, уже использованные на практике:
<BR>
|
<BR>
|   - основные оптимизации делаются (в новой реализации Рефала Плюс --
<BR>
|     не так ли? -- обращаюсь к трем А: Абрамову, Андрею и Антону)
<BR>
|     в независимом как от входного языка, так и от выходного
<BR>
|     отображения виде -- на AS по терминологии Абрамова;
<BR>
|     (не говорю уж о том, что их можно разрабатывать, преподавать,
<BR>
|     строить теорию -- и все это в человеческом виде).
<BR>
|
<BR>
|   - нет проблемы естественного преобразования выхода
<BR>
|     суперкомпилятора(Рефал-графов) в Рефал (Плюс):
<BR>
|     понятий достаточно, не нужно порождать вспомогательные функции и т.п.;
<BR>
|     (это использовалось 2 раза: мной в 90-м году для суперкомпилятора
<BR>
|     Турчина 90-го года и в этом году Антоном О. и Юрой К. для Scp4).
<BR>
|
<BR>
| Крупная цель:
<BR>
|
<BR>
|     Ребята, ну, мы ж все время говорим о метасистемном переходе
<BR>
|     и метавычислениях -- о том, что тексты на языке должны
<BR>
|     стать объектом преобразований! -- и чем легче, проще и
<BR>
|     выразимее это будет, тем...
<BR>
|
<BR>
| Андрей.
<BR>
<P><!-- body="end" -->
<HR>
<P>
<UL>
<!-- next="start" -->
<LI><STRONG>Next message:</STRONG> <A HREF="0145.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>Previous message:</STRONG> <A HREF="0143.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>In reply to:</STRONG> <A HREF="0143.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<!-- nextthread="start" -->
<LI><STRONG>Next in thread:</STRONG> <A HREF="0145.html">Andrei Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<LI><STRONG>Reply:</STRONG> <A HREF="0143.html">Arkady Klimov: "Re: Evolution of programming languages Was: Об отсечениях внутри блока."</A>
<!-- reply="end" -->
</UL>
<!-- trailer="footer" -->
<HR>
<P>
<SMALL>
<EM>
This archive was generated by <A HREF="http://www.fts.frontec.se/~dast/hypermail/">hypermail 2b25</A> 
: <EM>Mon Oct 25 2004 - 21:24:58 MSD</EM>
</EM>
</SMALL>
</BODY>
</HTML>
